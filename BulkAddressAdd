$json = Get-Content C:\Temp\addressdatainput.json | ConvertFrom-Json
$csv = Get-Content C:\Temp\inputexcel.csv | ConvertFrom-CSV

foreach ($endpoint in $csv) {
    $AddressNames = ($endpoint.AddressName) 
    $AddressValues = ($endpoint.AddressValue)
    #-replace '\*\.',''
    #AND ($AddressValue in $AddressValues)
    Foreach ($AddressName in $AddressNames) {
        try
        {
        #echo $AddressName
        #echo $endpoint.Addresstype
        #echo $endpoint.AddressValue
        #echo $endpoint.AddressDescription
        #echo Set-PaAddress -Name $AddressName -Value $endpoint.AddressValue -Type $endpoint.Addresstype -Description $endpoint.AddressDescription -ErrorAction Stop >> C:\Temp\configdiff.txt
           Set-PaAddress -Name $AddressName -Value $endpoint.AddressValue -Type $endpoint.Addresstype -Description $endpoint.AddressDescription -ErrorAction Stop 
           Set-PaAddressGroup -Name $endpoint.AddressGroup -Member $AddressName -ErrorAction Stop 
        }
        
        catch
        {
            $AddressName
        }
    }
}
date >> C:\Temp\configdiff.txt
Get-paConfigDiff >> C:\Temp\configdiff.txt
Invoke-PaCommit -Confirm
